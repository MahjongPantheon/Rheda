Riichi Statboard
================
[![Build Status](https://travis-ci.org/Furiten/riichi-statboard.svg?branch=master)](https://travis-ci.org/Furiten/riichi-statboard)

Маленький набор скриптов на php и js для быстрого ввода данных по играм и их быстрого и информативного отображения
где угодно. Также прилагаются примеры бланков для записи результатов сыгранных игр (см. папку blanks).

Как это выглядит: http://turnir.furiten.ru/last/

Поддерживается:
- Регистрация игроков
- Генерация рассадки после партий на основе всей выборки игроков (для турниров)
    - Учитывает кто сколько и с кем раз сыграл и генерирует очередную рассадку, минимизируя пересечения
    между одними и теми же игроками за игровым столом.
    - Учитывает выигрыши и проигрыши, т.е. после первой игры победители сядут с победителями,
    а проигравшие - с проигравшими.
    - Учитывает только полную выборку игроков и пригодна только для турниров.
- Ввод информации в фиксированном текстовом формате:
    - Итоги игры (используются как основа для подсчетов)
    - Кто и с кого выиграл, ничьи, кто темпай
    - Количество хан/фу
    - Ввод алиасов имен игроков (для ускорения ручного ввода)
- Построение статистики:
    - Последние сыгранные игры:
        - Наибольший выигрыш, кто, сколько
        - Сколько раздач сыграно, сколько ничьих
    - Статистика игроков:
        - Персональный индекс на основе всех сыгранных игр
        - Рейтинг игроков на основе персонального индекса и среднего места
        - Графики:
            - Распределение стоимости рук
            - Временная диаграмма изменения персонального индекса
        - Проценты по занятым местам
- Особые номинации (требуется допиливать самостоятельно)
- Особая страница с таймером для игр. Умеет проигрывать оповещения за 5 минут и в конце игры.
    - Таймер обновляется раз в 10 секунд, чтобы не отвлекать игроков чрезмерным морганием
    - Можно установить таймер на нужное время, передав параметр init, например: /timer/?init=20:00


Требования и инсталляция
------------------------

- PHP 5.5+
- Apache с mod_rewrite или Nginx
- Mysql 5

Предполагается, что пользователь знаком с механизмами работы php-сайтов и в состоянии
самостоятельно развернуть необходимую инфраструктуру.

Для nginx предоставляется файл-пример конфигурации (bin/configs/nginx.conf), для apache - .htaccess с конфигурацией mod_rewrite.
Для установки БД необходимо:
- Установить параметры БД в config/const.php
- Запустить на сервере из консоли scripts/DbInstall.php

После выполнения этих шагов системой можно пользоваться.


Локальная разработка
---------

Для работы над системой у вас есть два пути

- Настроить все самостоятельно как вам удобно (подойдет более опытным разработчикам)
- Использовать предоставленный vagrant файл

Рассмотрим второй вариант более подробно:

1. Для начала нужно установить [VirtualBox](https://www.virtualbox.org/wiki/Downloads) и [Vagrant](https://www.vagrantup.com/downloads.html)
2. Открыть в терминале папку с проектом и выполнить команду `vagrant up`
3. После этого нужно открыть в браузере [http://localhost:9000/](http://localhost:9000/) и все должно работать
4. При редактировании и сохранении файлов они автоматически будут загружены в vagrant
5. Внутрь вагранта можно попасть командой `vagrant ssh`, там Ubuntu 14.04
6. Mysql будет смотреть наружу на 3336 порту (localhost:3336)

От автора
---------

Буду благодарен любой помощи, включая:
- Составление подробной инструкции по использованию статистики
- Указание на неточности, странности (через раздел Issues можно заводить баги)
- Улучшения, пулреквесты, описание тестовых случаев, итд.
- Любая конструктивная помощь приветствуется, форкать репозиторий - позволяется и рекомендуется,
но также очень рекомендуется делиться наработками с оригинальным репозиторием :)

Также по вопросам можно писать на email heilage.nsk@gmail.com с пометкой "Riichi-statboard".
